<!doctype html>
<html>
    <head>
    <title>test</title>
        <link rel="stylesheet" type="text/css" href="css/main.css">
        <script src="js/jquery-3.2.1.js"></script>
    </head>
    <body style="background: none;">
        <div class="toolbar" id="toolbar">
            <div class="block" id = "0" onClick="clickTool(this)" style="border: 3px solid black;">eraser</div>
            <div class="block" id = "0" onClick="toggleGrid()">grid</div>
            <br>
            <script>
                
                var gridShow = false;
                function toggleGrid() {
                    if (gridShow) {
                        $(".gridBox").css("border", "none");
                        gridShow = false;
                    } else {
                        $(".gridBox").css("border", "1px solid gray");
                        gridShow = true;
                    }
                }
                //TODO: add second array for background layer
                function clickTool(tool) {
                    tool.style.border='3px solid black'; document.getElementById(selection).style.border='none'; selection = tool.id;
                }
                
                for(i = 1; i < 48; i++) {
                    var imageBG = "images/" + i + ".png";
                    $("#toolbar").append("<img class='block' id='" + i + "' onClick='clickTool(this)' src='" + imageBG + "'></div>");
                }
            </script>
        </div>
        <div class="grid" id="grid"> </div>
        <script>
            
            grid.vals = [
                ["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],
                ["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],
                ["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],
                ["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],
                ["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],
                ["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],
                ["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],
                ["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],
                ["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],
                ["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],
                ["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],
                ["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],
                ["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],
                ["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],
                ["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],
                ["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],
                ["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],
                ["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],
                ["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],
                ["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"]
            ];
            
            var selection = 0;
            //create grid layout
            for (y = 0; y < 20; y++) {
                for (x = 0; x < 30; x++) {
                    $("#grid").append("<img class='gridLayer1' id='" + x.toString() + "-" + y.toString() + "' data-x='" + x + "' data-y='" + y +"' style='bottom: " + y*70 + "px; left: " + (220+ x * 70) + "px'></div>");
                }
            }
            
            for (y = 0; y < 20; y++) {
                for (x = 0; x < 30; x++) {
                    $("#grid").append("<div class='gridBox' data-x='" + x + "' data-y='" + y +"' style='bottom: " + y*70 + "px; left: " + (220 + x * 70) + "px' onmousedown='changeBG(" + x + ", " + y + ")'></div>");
                }
            }
            
            function changeBG(x, y) {
                box = "#" + x.toString() + "-" + y.toString();
                $(box)[0].src = "images/" + selection + ".png";
                grid.vals[y][x] = selection;
            }
            
            $("#grid").mousedown(function() {
                $(".gridBox").mouseover(function() {changeBG(this.dataset.x, this.dataset.y)});
            });
            
            $("#grid").mouseup(function() {
                $(".gridBox").off("mouseover");
            });
        </script>
    </body>
</html>